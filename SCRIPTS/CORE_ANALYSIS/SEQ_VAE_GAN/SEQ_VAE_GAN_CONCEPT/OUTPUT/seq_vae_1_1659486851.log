batch_size=32,z_size=64,seq_len=8,emb_dim=64,vocab_size=5000,hidden_dim=32,dropout_keep_prob=0.75,free_bits=0,encoder_learning_rate=0.01,enc_rnn_size=[32, 32],residual_encoder=True,dencoder_learning_rate=0.01,compute_rewards_step=1,dec_update_rate=0.8,rollout_num=16,dis_learning_rate=0.0001,dis_train_freq=5,dis_filter_sizes=[1, 2, 3, 4, 6, 8],dis_num_filters=[100, 200, 100, 200, 200, 100]
Start pre-training...
pre-train epoch  0 kl_loss:  1.9970177 r_loss:  8.165026 nll:  11.272421
pre-train epoch  5 kl_loss:  1.2481674 r_loss:  5.7689404 nll:  11.307568
pre-train epoch  10 kl_loss:  1.3581793 r_loss:  3.3832557 nll:  11.284873
pre-train epoch  15 kl_loss:  0.026253514 r_loss:  2.157779 nll:  11.276738
pre-train epoch  20 kl_loss:  0.00440417 r_loss:  1.5925186 nll:  11.268611
pre-train epoch  25 kl_loss:  0.00334116 r_loss:  1.3170484 nll:  11.276501
pre-train epoch  30 kl_loss:  0.0013149028 r_loss:  1.162555 nll:  11.277564
pre-train epoch  35 kl_loss:  0.0023906322 r_loss:  1.0816437 nll:  11.279222
Start pre-training discriminator...
#########################################################################
Start Training...
epoch:  0 kl_loss:  0.020531062 pg_loss:  26.897655 nll:  11.29245
epoch:  1 kl_loss:  0.06790233 pg_loss:  20.996803 nll:  11.308757
epoch:  2 kl_loss:  0.109541506 pg_loss:  22.272617 nll:  11.290946
epoch:  3 kl_loss:  0.15683013 pg_loss:  18.697683 nll:  11.298512
epoch:  4 kl_loss:  0.106703885 pg_loss:  19.17976 nll:  11.320735
epoch:  5 kl_loss:  0.069461375 pg_loss:  20.128906 nll:  11.303201
epoch:  6 kl_loss:  0.07401778 pg_loss:  18.768665 nll:  11.305326
epoch:  7 kl_loss:  0.09910144 pg_loss:  14.789476 nll:  11.30936
epoch:  8 kl_loss:  0.126721 pg_loss:  15.919008 nll:  11.279395
epoch:  9 kl_loss:  0.1446706 pg_loss:  19.264587 nll:  11.292062
epoch:  10 kl_loss:  0.14107114 pg_loss:  11.403308 nll:  11.299274
epoch:  11 kl_loss:  0.12093536 pg_loss:  19.364332 nll:  11.266966
epoch:  12 kl_loss:  0.09143879 pg_loss:  17.165592 nll:  11.267737
epoch:  13 kl_loss:  0.067126125 pg_loss:  14.013417 nll:  11.27607
epoch:  14 kl_loss:  0.05161971 pg_loss:  12.802792 nll:  11.269908
epoch:  15 kl_loss:  0.048855856 pg_loss:  13.223072 nll:  11.264052
epoch:  16 kl_loss:  0.050069727 pg_loss:  11.9376335 nll:  11.265409
epoch:  17 kl_loss:  0.050726693 pg_loss:  13.720102 nll:  11.260317
epoch:  18 kl_loss:  0.0478538 pg_loss:  12.434755 nll:  11.244687
epoch:  19 kl_loss:  0.042085912 pg_loss:  7.7940598 nll:  11.237164
epoch:  20 kl_loss:  0.03568455 pg_loss:  9.152262 nll:  11.226534
epoch:  21 kl_loss:  0.034405068 pg_loss:  11.883955 nll:  11.214586
epoch:  22 kl_loss:  0.037147045 pg_loss:  9.0846195 nll:  11.232629
epoch:  23 kl_loss:  0.0506213 pg_loss:  7.112629 nll:  11.232178
epoch:  24 kl_loss:  0.04011249 pg_loss:  8.194382 nll:  11.198409
epoch:  25 kl_loss:  0.041015096 pg_loss:  6.1993656 nll:  11.214956
epoch:  26 kl_loss:  0.036953583 pg_loss:  11.85391 nll:  11.215251
epoch:  27 kl_loss:  0.029830646 pg_loss:  8.306303 nll:  11.206298
epoch:  28 kl_loss:  0.022474242 pg_loss:  8.734259 nll:  11.200476
epoch:  29 kl_loss:  0.020235721 pg_loss:  6.023117 nll:  11.198257
epoch:  30 kl_loss:  0.013302099 pg_loss:  10.185204 nll:  11.218105
epoch:  31 kl_loss:  0.0128284125 pg_loss:  5.0780144 nll:  11.219619
epoch:  32 kl_loss:  0.014009782 pg_loss:  4.838978 nll:  11.222847
epoch:  33 kl_loss:  0.014709146 pg_loss:  10.1828785 nll:  11.228266
epoch:  34 kl_loss:  0.01854929 pg_loss:  6.719131 nll:  11.257265
epoch:  35 kl_loss:  0.038177498 pg_loss:  12.062523 nll:  11.240044
epoch:  36 kl_loss:  0.025596237 pg_loss:  7.841799 nll:  11.256897
epoch:  37 kl_loss:  0.034611847 pg_loss:  8.925712 nll:  11.263535
epoch:  38 kl_loss:  0.027908374 pg_loss:  7.0837374 nll:  11.255658
epoch:  39 kl_loss:  0.023538584 pg_loss:  6.433382 nll:  11.262307
epoch:  40 kl_loss:  0.02032016 pg_loss:  6.2598658 nll:  11.275103
epoch:  41 kl_loss:  0.019210067 pg_loss:  7.6978827 nll:  11.263347
epoch:  42 kl_loss:  0.020090869 pg_loss:  7.9743876 nll:  11.272468
epoch:  43 kl_loss:  0.024561271 pg_loss:  6.4623594 nll:  11.273674
epoch:  44 kl_loss:  0.020498738 pg_loss:  5.803224 nll:  11.287452
epoch:  45 kl_loss:  0.028369084 pg_loss:  8.670763 nll:  11.310799
epoch:  46 kl_loss:  0.02863637 pg_loss:  4.896681 nll:  11.301714
epoch:  47 kl_loss:  0.043411277 pg_loss:  3.279047 nll:  11.295798
epoch:  48 kl_loss:  0.040219262 pg_loss:  10.0714245 nll:  11.291313
epoch:  49 kl_loss:  0.034093034 pg_loss:  4.7284307 nll:  11.298048
epoch:  50 kl_loss:  0.029063396 pg_loss:  5.9745545 nll:  11.309089
epoch:  51 kl_loss:  0.042045582 pg_loss:  6.5303288 nll:  11.30973
epoch:  52 kl_loss:  0.04472186 pg_loss:  4.6702843 nll:  11.328085
epoch:  53 kl_loss:  0.042691637 pg_loss:  7.0458117 nll:  11.31061
epoch:  54 kl_loss:  1.7157948 pg_loss:  6.3152323 nll:  11.310207
epoch:  55 kl_loss:  0.087493286 pg_loss:  5.5459824 nll:  11.3382435
epoch:  56 kl_loss:  0.02492615 pg_loss:  5.242654 nll:  11.315323
epoch:  57 kl_loss:  0.022670172 pg_loss:  4.3502913 nll:  11.330577
epoch:  58 kl_loss:  0.023604846 pg_loss:  5.1199856 nll:  11.331022
epoch:  59 kl_loss:  0.02234341 pg_loss:  6.8218393 nll:  11.333123
epoch:  60 kl_loss:  0.02122391 pg_loss:  8.333036 nll:  11.336299
epoch:  61 kl_loss:  0.019163098 pg_loss:  4.128805 nll:  11.3415365
epoch:  62 kl_loss:  0.016959548 pg_loss:  2.3170154 nll:  11.338968
epoch:  63 kl_loss:  0.014926226 pg_loss:  7.628131 nll:  11.351026
epoch:  64 kl_loss:  0.013348746 pg_loss:  3.5825658 nll:  11.345859
epoch:  65 kl_loss:  0.012034189 pg_loss:  4.8265953 nll:  11.355031
epoch:  66 kl_loss:  0.010955219 pg_loss:  3.3103845 nll:  11.339205
epoch:  67 kl_loss:  0.009815736 pg_loss:  6.1169095 nll:  11.338948
epoch:  68 kl_loss:  0.0085354075 pg_loss:  4.231185 nll:  11.338538
epoch:  69 kl_loss:  0.007231999 pg_loss:  6.1757274 nll:  11.339296
epoch:  70 kl_loss:  0.0064684805 pg_loss:  6.7124176 nll:  11.340971
epoch:  71 kl_loss:  0.006038074 pg_loss:  3.1197517 nll:  11.355665
epoch:  72 kl_loss:  0.006006095 pg_loss:  3.8686945 nll:  11.341304
epoch:  73 kl_loss:  0.006902106 pg_loss:  3.9372613 nll:  11.335556
epoch:  74 kl_loss:  0.0071201194 pg_loss:  3.4969945 nll:  11.356997
epoch:  75 kl_loss:  0.0067728907 pg_loss:  3.4017527 nll:  11.351244
epoch:  76 kl_loss:  0.006055438 pg_loss:  3.7877483 nll:  11.339069
epoch:  77 kl_loss:  0.00548105 pg_loss:  4.551951 nll:  11.352845
epoch:  78 kl_loss:  0.004134168 pg_loss:  5.965171 nll:  11.375153
epoch:  79 kl_loss:  0.0038968492 pg_loss:  4.258015 nll:  11.355079
epoch:  80 kl_loss:  0.0035520275 pg_loss:  3.72047 nll:  11.351365
epoch:  81 kl_loss:  0.0036665355 pg_loss:  4.3775053 nll:  11.355076
epoch:  82 kl_loss:  0.0038828892 pg_loss:  6.2860184 nll:  11.35145
epoch:  83 kl_loss:  0.003960613 pg_loss:  11.20326 nll:  11.3458395
epoch:  84 kl_loss:  0.004066852 pg_loss:  6.0386677 nll:  11.3378315
epoch:  85 kl_loss:  0.0034996788 pg_loss:  3.9155676 nll:  11.33561
epoch:  86 kl_loss:  0.003979934 pg_loss:  3.3982534 nll:  11.329003
epoch:  87 kl_loss:  0.0048128227 pg_loss:  4.201681 nll:  11.319399
epoch:  88 kl_loss:  0.00538393 pg_loss:  4.2486153 nll:  11.331775
epoch:  89 kl_loss:  0.005318842 pg_loss:  5.099806 nll:  11.347471
epoch:  90 kl_loss:  0.004911356 pg_loss:  3.6552913 nll:  11.323276
epoch:  91 kl_loss:  0.0041486965 pg_loss:  4.8285246 nll:  11.324295
epoch:  92 kl_loss:  0.003811474 pg_loss:  4.866213 nll:  11.324309
epoch:  93 kl_loss:  0.0039953412 pg_loss:  5.956699 nll:  11.312222
epoch:  94 kl_loss:  0.0043226667 pg_loss:  3.9659452 nll:  11.318364
epoch:  95 kl_loss:  0.004606064 pg_loss:  3.1524885 nll:  11.3439
epoch:  96 kl_loss:  0.0039582546 pg_loss:  3.2471726 nll:  11.323663
epoch:  97 kl_loss:  0.0031335247 pg_loss:  4.9873295 nll:  11.343175
epoch:  98 kl_loss:  0.0023952601 pg_loss:  3.8443298 nll:  11.34435
epoch:  99 kl_loss:  0.0017854492 pg_loss:  3.3969278 nll:  11.341662
epoch:  100 kl_loss:  0.0016271903 pg_loss:  2.6326542 nll:  11.322622
epoch:  101 kl_loss:  0.0018369657 pg_loss:  4.819115 nll:  11.340662
epoch:  102 kl_loss:  0.0021226401 pg_loss:  5.701938 nll:  11.3203945
epoch:  103 kl_loss:  0.0023444938 pg_loss:  2.9715667 nll:  11.34237
epoch:  104 kl_loss:  0.0023887288 pg_loss:  5.8521385 nll:  11.336489
epoch:  105 kl_loss:  0.027567321 pg_loss:  4.368923 nll:  11.328725
epoch:  106 kl_loss:  0.001879144 pg_loss:  4.558196 nll:  11.335054
epoch:  107 kl_loss:  0.0018972991 pg_loss:  4.068853 nll:  11.321868
epoch:  108 kl_loss:  0.002096907 pg_loss:  3.083687 nll:  11.335427
epoch:  109 kl_loss:  0.00217654 pg_loss:  3.0620108 nll:  11.343997
epoch:  110 kl_loss:  0.0022484278 pg_loss:  3.1527185 nll:  11.339115
epoch:  111 kl_loss:  0.0019600792 pg_loss:  5.0819597 nll:  11.3460455
epoch:  112 kl_loss:  0.0027918625 pg_loss:  3.2714555 nll:  11.353946
epoch:  113 kl_loss:  0.004831328 pg_loss:  4.2230153 nll:  11.357212
epoch:  114 kl_loss:  0.0068545556 pg_loss:  3.3469958 nll:  11.357107
epoch:  115 kl_loss:  0.0077004447 pg_loss:  5.2872267 nll:  11.358235
epoch:  116 kl_loss:  0.006990885 pg_loss:  6.909456 nll:  11.370706
epoch:  117 kl_loss:  0.005340035 pg_loss:  4.8021636 nll:  11.369692
epoch:  118 kl_loss:  0.0036176862 pg_loss:  4.0997257 nll:  11.395946
epoch:  119 kl_loss:  0.0025098354 pg_loss:  5.7542696 nll:  11.390168
epoch:  120 kl_loss:  0.0022724266 pg_loss:  3.7471218 nll:  11.39572
epoch:  121 kl_loss:  0.002672521 pg_loss:  4.4130363 nll:  11.382801
epoch:  122 kl_loss:  0.003292381 pg_loss:  5.494176 nll:  11.385653
epoch:  123 kl_loss:  0.0038893793 pg_loss:  3.6172688 nll:  11.400529
epoch:  124 kl_loss:  0.0041620815 pg_loss:  3.4103854 nll:  11.387747
epoch:  125 kl_loss:  0.004128564 pg_loss:  2.9355636 nll:  11.383766
epoch:  126 kl_loss:  0.0038380136 pg_loss:  3.2314286 nll:  11.367807
epoch:  127 kl_loss:  0.0034754896 pg_loss:  3.5732265 nll:  11.385808
epoch:  128 kl_loss:  0.0034642115 pg_loss:  5.0861754 nll:  11.379258
epoch:  129 kl_loss:  0.003578003 pg_loss:  3.8747663 nll:  11.389717
epoch:  130 kl_loss:  0.0037002286 pg_loss:  3.585601 nll:  11.368114
epoch:  131 kl_loss:  0.0034122164 pg_loss:  2.9381905 nll:  11.376936
epoch:  132 kl_loss:  0.0027900005 pg_loss:  4.0597043 nll:  11.392536
epoch:  133 kl_loss:  0.0022543855 pg_loss:  3.4871135 nll:  11.365565
epoch:  134 kl_loss:  0.0020186133 pg_loss:  3.232438 nll:  11.362766
epoch:  135 kl_loss:  0.0020792456 pg_loss:  5.0424047 nll:  11.372397
epoch:  136 kl_loss:  0.0023306694 pg_loss:  3.2056582 nll:  11.373682
epoch:  137 kl_loss:  0.0026316473 pg_loss:  3.748565 nll:  11.380257
epoch:  138 kl_loss:  0.002433901 pg_loss:  3.9219153 nll:  11.36389
epoch:  139 kl_loss:  0.0020709257 pg_loss:  3.819047 nll:  11.376756
epoch:  140 kl_loss:  0.0014729863 pg_loss:  2.9666765 nll:  11.36896
epoch:  141 kl_loss:  0.0013604971 pg_loss:  3.5221734 nll:  11.392044
epoch:  142 kl_loss:  0.0016167046 pg_loss:  2.9248936 nll:  11.393763
epoch:  143 kl_loss:  0.0020729771 pg_loss:  6.598032 nll:  11.413355
epoch:  144 kl_loss:  0.0025593995 pg_loss:  4.6431837 nll:  11.409258
epoch:  145 kl_loss:  0.003267059 pg_loss:  7.5809064 nll:  11.385938
epoch:  146 kl_loss:  0.003156222 pg_loss:  2.8062482 nll:  11.41617
epoch:  147 kl_loss:  0.002446524 pg_loss:  3.7971895 nll:  11.419047
epoch:  148 kl_loss:  0.001917501 pg_loss:  2.9057503 nll:  11.416949
epoch:  149 kl_loss:  0.0014244979 pg_loss:  4.213211 nll:  11.40283
epoch:  150 kl_loss:  0.0012405844 pg_loss:  2.3926978 nll:  11.405591
epoch:  151 kl_loss:  0.0012473199 pg_loss:  3.4825478 nll:  11.403702
epoch:  152 kl_loss:  0.0013823614 pg_loss:  3.9237928 nll:  11.411492
epoch:  153 kl_loss:  0.0014149325 pg_loss:  4.3626275 nll:  11.39647
epoch:  154 kl_loss:  0.0014620704 pg_loss:  2.2395477 nll:  11.408825
epoch:  155 kl_loss:  0.0015517821 pg_loss:  3.5111437 nll:  11.389025
epoch:  156 kl_loss:  0.0015573418 pg_loss:  4.4200635 nll:  11.413023
epoch:  157 kl_loss:  0.0013994568 pg_loss:  2.4659488 nll:  11.396824
epoch:  158 kl_loss:  0.0012150333 pg_loss:  3.085658 nll:  11.393554
epoch:  159 kl_loss:  0.0009772046 pg_loss:  2.6105294 nll:  11.411631
epoch:  160 kl_loss:  0.00078955473 pg_loss:  3.5265858 nll:  11.409797
epoch:  161 kl_loss:  0.0007164314 pg_loss:  3.1409705 nll:  11.39617
epoch:  162 kl_loss:  0.0009299335 pg_loss:  3.5457096 nll:  11.415207
epoch:  163 kl_loss:  0.0011957699 pg_loss:  3.1428823 nll:  11.397424
epoch:  164 kl_loss:  0.0014015022 pg_loss:  4.6526275 nll:  11.416773
epoch:  165 kl_loss:  0.0014906527 pg_loss:  2.551717 nll:  11.415888
epoch:  166 kl_loss:  0.0014393688 pg_loss:  6.9879284 nll:  11.420051
epoch:  167 kl_loss:  0.0013891063 pg_loss:  2.6480577 nll:  11.405722
epoch:  168 kl_loss:  0.0012256969 pg_loss:  4.1322775 nll:  11.413784
epoch:  169 kl_loss:  0.0011972158 pg_loss:  2.8636603 nll:  11.418489
epoch:  170 kl_loss:  0.0012978103 pg_loss:  4.6572056 nll:  11.419876
epoch:  171 kl_loss:  0.0011918495 pg_loss:  3.813901 nll:  11.417427
epoch:  172 kl_loss:  0.0012106241 pg_loss:  2.1716223 nll:  11.412426
epoch:  173 kl_loss:  0.0011580026 pg_loss:  3.3181448 nll:  11.419497
epoch:  174 kl_loss:  0.0010477814 pg_loss:  4.054306 nll:  11.424478
epoch:  175 kl_loss:  0.00081122987 pg_loss:  4.2588167 nll:  11.419124
epoch:  176 kl_loss:  0.0005772868 pg_loss:  3.711709 nll:  11.417888
epoch:  177 kl_loss:  0.00043011594 pg_loss:  2.6541095 nll:  11.403811
epoch:  178 kl_loss:  0.0005391531 pg_loss:  4.013852 nll:  11.420596
epoch:  179 kl_loss:  0.0010534108 pg_loss:  4.3950706 nll:  11.396974
epoch:  180 kl_loss:  0.0016439178 pg_loss:  2.596536 nll:  11.38326
epoch:  181 kl_loss:  0.0020017438 pg_loss:  3.1328073 nll:  11.3609295
epoch:  182 kl_loss:  0.0020087496 pg_loss:  5.3541985 nll:  11.369452
epoch:  183 kl_loss:  0.0016988779 pg_loss:  3.5488648 nll:  11.36671
epoch:  184 kl_loss:  0.0024013375 pg_loss:  2.839612 nll:  11.377008
epoch:  185 kl_loss:  0.0010935967 pg_loss:  5.0513625 nll:  11.348521
epoch:  186 kl_loss:  0.0013936388 pg_loss:  4.044318 nll:  11.3331175
epoch:  187 kl_loss:  0.0018975873 pg_loss:  3.773005 nll:  11.349308
epoch:  188 kl_loss:  0.002243046 pg_loss:  5.0528927 nll:  11.333144
epoch:  189 kl_loss:  0.0022512479 pg_loss:  3.4975276 nll:  11.343496
epoch:  190 kl_loss:  0.0021804906 pg_loss:  4.5812435 nll:  11.33995
epoch:  191 kl_loss:  0.0018856162 pg_loss:  3.6409547 nll:  11.32593
epoch:  192 kl_loss:  0.0015769014 pg_loss:  2.3623354 nll:  11.33246
epoch:  193 kl_loss:  0.0011782448 pg_loss:  3.310097 nll:  11.328742
epoch:  194 kl_loss:  0.0009938667 pg_loss:  2.6083038 nll:  11.33614
epoch:  195 kl_loss:  0.00092765916 pg_loss:  2.0766702 nll:  11.320539
epoch:  196 kl_loss:  0.0009816305 pg_loss:  3.1654863 nll:  11.319165
epoch:  197 kl_loss:  0.0011501231 pg_loss:  3.4652276 nll:  11.337461
epoch:  198 kl_loss:  0.0017217107 pg_loss:  4.9917707 nll:  11.316043
epoch:  199 kl_loss:  0.0036178087 pg_loss:  2.990535 nll:  11.33217
epoch:  200 kl_loss:  0.006080308 pg_loss:  2.4847963 nll:  11.326241
epoch:  201 kl_loss:  0.0038256499 pg_loss:  2.8680782 nll:  11.312612
epoch:  202 kl_loss:  0.002971523 pg_loss:  6.7479734 nll:  11.32448
epoch:  203 kl_loss:  0.0028826438 pg_loss:  4.271283 nll:  11.315196
epoch:  204 kl_loss:  0.005459603 pg_loss:  4.9409294 nll:  11.337293
epoch:  205 kl_loss:  0.0038840165 pg_loss:  3.0511627 nll:  11.335554
epoch:  206 kl_loss:  0.0141022755 pg_loss:  2.1474783 nll:  11.343364
epoch:  207 kl_loss:  0.008528503 pg_loss:  3.4618495 nll:  11.340493
epoch:  208 kl_loss:  0.008651829 pg_loss:  3.624674 nll:  11.342258
epoch:  209 kl_loss:  0.0073922407 pg_loss:  3.4779038 nll:  11.356757
epoch:  210 kl_loss:  0.0061876485 pg_loss:  4.340687 nll:  11.349861
epoch:  211 kl_loss:  0.004987991 pg_loss:  4.3802347 nll:  11.366484
epoch:  212 kl_loss:  0.004630925 pg_loss:  3.4603534 nll:  11.356469
epoch:  213 kl_loss:  0.0049014194 pg_loss:  3.40727 nll:  11.348011
epoch:  214 kl_loss:  0.0050468347 pg_loss:  6.5051303 nll:  11.342456
epoch:  215 kl_loss:  0.0064060614 pg_loss:  4.7717752 nll:  11.34388
epoch:  216 kl_loss:  0.008501895 pg_loss:  3.385767 nll:  11.344368
epoch:  217 kl_loss:  0.009787705 pg_loss:  4.3394136 nll:  11.344944
epoch:  218 kl_loss:  0.009568801 pg_loss:  2.7057261 nll:  11.338521
epoch:  219 kl_loss:  0.007994641 pg_loss:  3.8178508 nll:  11.348794
epoch:  220 kl_loss:  0.0058218427 pg_loss:  1.8002431 nll:  11.333616
